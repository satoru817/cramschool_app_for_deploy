<!doctype html>
<html lang="ja" xmlns:th="https://www.thymeleaf.org">
<head>
    <div th:replace="~{fragment::head}"></div>
    <title>問合せ一覧</title>
    <link rel="stylesheet" th:href="@{/css/name_badge.css}" />
</head>
<body class="d-flex flex-column min-vh-100">
<div class="wrapper">
    <!-- ヘッダー -->
    <div th:replace="~{fragment::header}"></div>

    <main>
        <div class="container pt-4 pb-5 container">
            <h1 class="mb-4 text-center">問合せ一覧</h1>

            <div class="row justify-content-center">
                <div class="col-12">
                    <div class="card shadow-sm">
                        <div class="card-body">
                            <div class="table-responsive">
                                <table class="table table-hover align-middle mb-0">
                                    <thead class="table-light">
                                    <tr>
                                        <th scope="col">ID</th>
                                        <th scope="col">教室名</th>
                                        <th scope="col">氏名</th>
                                        <th scope="col">ファネル</th>
                                        <th scope="col">学年</th>
                                        <th scope="col">問合せ日</th>
                                    </tr>
                                    </thead>
                                    <tbody>
                                    <tr th:each="inquiry : ${inquiries}">
                                        <td class="text-muted" th:text="${inquiry.inquiryId}"></td>
                                        <td>
                                            <span class="badge text-bg-secondary shadow-sm"
                                                  th:text="${inquiry.cramSchool.name}">
                                            </span>
                                        </td>
                                        <td>
                                            <span class="badge text-bg-info shadow-sm badge_hover"
                                                  th:text="${inquiry.nameKanji}">
                                            </span>
                                        </td>
                                        <td>
                                            <span class="badge text-bg-primary shadow-sm"
                                                  th:text="${inquiry.funnel.name}">
                                            </span>
                                        </td>
                                        <td>
                                            <span class="fw-medium" th:text="${inquiry.gradeStr}"></span>
                                        </td>
                                        <td>
                                            <span class="text-muted"
                                                  th:text="${#temporals.format(inquiry.inquiryDate, 'yyyy/MM/dd')}">
                                            </span>
                                        </td>
                                    </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                    <!-- ページネーション -->
                    <div th:if="${inquiries.getTotalPages() > 1}" class="d-flex justify-content-center mt-4">
                        <nav aria-label="問合せ一覧ページ">
                            <ul class="pagination">
                                <!-- 前へボタン -->
                                <li class="page-item">
                                    <span th:if="${inquiries.isFirst()}" class="page-link pagination_itemBox rounded-circle disabled">
                                        <span class="pagination_prevArrow"></span>
                                    </span>
                                    <a th:unless="${inquiries.isFirst()}"
                                       th:href="@{/sales/inquiry/index(page=${inquiries.getNumber() - 1})}"
                                       class="page-link pagination_itemBox rounded-circle">
                                        <span class="pagination_prevArrow"></span>
                                    </a>
                                </li>

                                <!-- ページ番号（中央部分） -->
                                <th:block th:with="start=${inquiries.getNumber() <= 2 ? 0 : inquiries.getNumber() - 2},
                                                 end=${inquiries.getTotalPages() - inquiries.getNumber() <= 3 ? inquiries.getTotalPages() - 1 : inquiries.getNumber() + 2}">
                                    <li class="page-item" th:each="i : ${#numbers.sequence(start, end)}">
                                        <span th:if="${i == inquiries.getNumber()}"
                                              class="page-link pagination_itemBox rounded-circle active"
                                              th:text="${i + 1}">
                                        </span>
                                        <a th:unless="${i == inquiries.getNumber()}"
                                           th:href="@{/sales/inquiry/index(page=${i})}"
                                           class="page-link pagination_itemBox rounded-circle"
                                           th:text="${i + 1}">
                                        </a>
                                    </li>
                                </th:block>

                                <!-- 次へボタン -->
                                <li class="page-item">
                                    <span th:if="${inquiries.isLast()}" class="page-link pagination_itemBox rounded-circle disabled">
                                        <span class="pagination_nextArrow"></span>
                                    </span>
                                    <a th:unless="${inquiries.isLast()}"
                                       th:href="@{/sales/inquiry/index(page=${inquiries.getNumber() + 1})}"
                                       class="page-link pagination_itemBox rounded-circle">
                                        <span class="pagination_nextArrow"></span>
                                    </a>
                                </li>
                            </ul>
                        </nav>
                    </div>
                </div>
            </div>
        </div>
    </main>
</div>

<!-- フッター -->
<div th:replace="~{fragment::footer}"></div>
</body>
</html>